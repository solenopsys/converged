import{u as e}from"./jsxRuntime-BreS2Ahj.js";import{d as h,y as _,q as B,T as z,k as j}from"./iframe-BIqZQAoS.js";import"./compat-CeQs_Ny8.js";import{i as G,B as F,L as S,I as C,a as R}from"./command-WPKR8Qp8.js";import"./lucide-preact-CyBEQqbl.js";import"./preload-helper-Dp1pzeXC.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./compat.module-Cr6-0uw_.js";const E=r=>{const[n,a]=h(!1),[t,w]=h(null),[m,f]=h("en"),[l,p]=h(null);_(()=>{let o=!0,i;return(async()=>{try{const s=await(window.__I18N_INIT_PROMISE__||G());if(!o)return;r&&(s.hasLoadedNamespace(r,s.language)||await new Promise(O=>{const k=()=>{s.hasLoadedNamespace(r,s.language)?O():setTimeout(k,100)};k()})),w(s),f(s.language),a(!0),p(null);const d=g=>{f(g)},c=()=>{r&&s.hasLoadedNamespace(r,s.language)&&a(!0)};s.on&&s.off&&(s.on("languageChanged",d),s.on("loaded",c),i=()=>{s.off("languageChanged",d),s.off("loaded",c)})}catch(s){if(!o)return;console.error("Failed to initialize i18n:",s),p("Failed to load translations"),window.__GLOBAL_I18N_INSTANCE__&&(w(window.__GLOBAL_I18N_INSTANCE__),f(window.__GLOBAL_I18N_INSTANCE__.language),a(!0))}})(),()=>{o=!1,i&&i()}},[r]);const u=B((o,i,y)=>{if(!n||!t)return i||o;const s=`${r}:${o}`,d=t.t(s,y);return(d===s||d===o)&&i?i:d},[n,t,r]),v={language:m,languages:(t==null?void 0:t.languages)||["ru","en"],getResource:(o,i,y)=>(t==null?void 0:t.getResource(o,i,y))||null,changeLanguage:async o=>{if(t!=null&&t.changeLanguage)try{await t.changeLanguage(o)}catch(i){console.error("Failed to change language:",i)}},t:(o,i)=>(t==null?void 0:t.t(o,i))||o,hasLoadedNamespace:(o,i)=>(t==null?void 0:t.hasLoadedNamespace(o,i))||!1};return{t:u,i18n:v,ready:n&&!!t,error:l}},N=(r,n)=>{},x={success:N,error:N,info:N,warning:N},J={async listProviderTemplates(){return[{provider:"google",displayName:"Google"},{provider:"apple",displayName:"Apple"},{provider:"microsoft",displayName:"Microsoft"},{provider:"meta",displayName:"Meta"},{provider:"github",displayName:"GitHub"}]},async listEnabledProviders(){return[{provider:"google"},{provider:"github"},{provider:"microsoft"},{provider:"apple"},{provider:"meta"}]}},L=[{provider:"google",displayName:"Google"},{provider:"apple",displayName:"Apple"},{provider:"microsoft",displayName:"Microsoft"},{provider:"meta",displayName:"Meta"},{provider:"github",displayName:"GitHub"}];function W({provider:r}){const n="size-4 shrink-0";return r==="microsoft"?e("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",children:e("path",{d:"M2 3h9v9H2V3zM13 3h9v9h-9V3zM2 14h9v9H2v-9zM13 14h9v9h-9v-9z",fill:"currentColor"})}):r==="apple"?e("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",children:e("path",{d:"M12.15 6.9c-.95 0-2.42-1.08-3.96-1.04-2.04.03-3.91 1.18-4.96 3.01-2.12 3.68-.55 9.1 1.52 12.09 1.01 1.46 2.21 3.09 3.79 3.04 1.52-.07 2.09-.99 3.94-.99 1.83 0 2.35.99 3.96.95 1.64-.03 2.68-1.48 3.68-2.95 1.15-1.69 1.63-3.33 1.66-3.41-.04-.01-3.18-1.22-3.22-4.86-.03-3.04 2.48-4.49 2.6-4.56-1.43-2.09-3.62-2.32-4.39-2.38-2-.16-3.68 1.09-4.61 1.09zM15.53 3.83c.84-1.01 1.4-2.43 1.24-3.83-1.2.05-2.66.81-3.53 1.82-.78.9-1.45 2.34-1.27 3.71 1.34.1 2.71-.69 3.56-1.7",fill:"currentColor"})}):r==="github"?e("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",children:e("path",{d:"M12 .5A11.5 11.5 0 0 0 .5 12a11.5 11.5 0 0 0 7.86 10.92c.57.1.78-.25.78-.55 0-.27-.01-1-.02-1.96-3.2.7-3.88-1.54-3.88-1.54-.52-1.33-1.28-1.68-1.28-1.68-1.04-.71.08-.7.08-.7 1.15.08 1.76 1.19 1.76 1.19 1.03 1.75 2.7 1.25 3.35.95.1-.74.4-1.25.73-1.54-2.55-.29-5.24-1.28-5.24-5.68 0-1.26.45-2.28 1.19-3.09-.12-.29-.52-1.46.11-3.04 0 0 .97-.31 3.17 1.18A10.98 10.98 0 0 1 12 6.1c.98 0 1.97.13 2.88.39 2.2-1.49 3.16-1.18 3.16-1.18.63 1.58.23 2.75.11 3.04.74.81 1.18 1.83 1.18 3.09 0 4.42-2.69 5.39-5.25 5.68.41.36.78 1.06.78 2.14 0 1.54-.01 2.78-.01 3.16 0 .31.2.67.79.55A11.5 11.5 0 0 0 23.5 12 11.5 11.5 0 0 0 12 .5z",fill:"currentColor"})}):r==="meta"?e("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",children:e("path",{d:"M7.2 9.3c1.3-2.5 2.7-3.8 4.2-3.8 1.4 0 2.5.9 3.3 2.7l.8 1.7.8-1.6c1.1-2.2 2.3-3.3 3.7-3.3 1.8 0 2.9 1.8 2.9 4.8 0 3.1-1.2 5.2-3 5.2-1.4 0-2.5-1-3.5-3.1l-.9-1.9-.9 1.8c-1.3 2.6-2.7 3.9-4.2 3.9-2.2 0-3.9-2.3-3.9-5.2 0-.9.2-1.8.7-2.9zm-2.8-.3C3 11.3 3 14.3 4.3 16.7c.9 1.7 2.3 2.8 4.1 2.8 2 0 3.6-1.2 5.1-3.9 1.2 2.3 2.8 3.5 4.7 3.5 3.4 0 5.8-3.3 5.8-8 0-4.6-2-7.4-5.3-7.4-2 0-3.7 1.2-5.2 3.8-1.1-2-2.7-3-4.6-3-2.1 0-4 1.3-5.5 4.5z",fill:"currentColor"})}):e("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24","aria-hidden":"true",children:e("path",{d:"M12.48 10.92v3.28h7.84c-.24 1.84-.85 3.19-1.79 4.13-1.15 1.15-2.93 2.4-6.05 2.4-4.83 0-8.6-3.89-8.6-8.72s3.77-8.72 8.6-8.72c2.6 0 4.51 1.03 5.91 2.35l2.31-2.31C18.75 1.44 16.13 0 12.48 0 5.87 0 .31 5.39.31 12s5.56 12 12.17 12c3.57 0 6.27-1.17 8.37-3.36 2.16-2.16 2.84-5.21 2.84-7.67 0-.76-.05-1.47-.17-2.05h-11.04z",fill:"currentColor"})})}function P(){const{t:r}=E("auth"),[n,a]=h(L);_(()=>{let l=!1;return(async()=>{try{const u=await J.listProviderTemplates();if(l)return;const v=Array.isArray(u)?u.map(o=>{const i=o==null?void 0:o.provider;return i?{provider:i,displayName:(o==null?void 0:o.displayName)||i}:null}).filter(Boolean):[];a(v.length>0?v:L)}catch{l||a(L)}})(),()=>{l=!0}},[]);const t=r("button.continueWith"),w=t&&t!=="button.continueWith"?t:"Continue with",m=z(()=>{const l=new Set;return n.filter(p=>l.has(p.provider)?!1:(l.add(p.provider),!0))},[n]),f=l=>{window.location.href=`/auth/connect/${l}`};return e("div",{className:"flex flex-col gap-3",children:[e("div",{className:"relative text-center text-xs text-muted-foreground",children:[e("div",{className:"absolute inset-0 top-1/2 flex -translate-y-1/2 items-center",children:e("span",{className:"w-full border-t"})}),e("span",{className:"relative bg-background px-2",children:w})]}),e("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:m.map(l=>e(F,{variant:"outline",type:"button",className:"w-full justify-start gap-2",onClick:()=>f(l.provider),children:[e(W,{provider:l.provider}),e("span",{children:l.displayName})]},l.provider))})]})}P.__docgenInfo={description:"",methods:[],displayName:"SocialsPanel"};function I({className:r,...n}){const{t:a}=E("auth"),[t,w]=h(""),[m,f]=h(""),[l,p]=h(!1),[u,v]=h(!1),y=u?async d=>{d.preventDefault(),p(!0);try{const c=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:m}),credentials:"include"}),g=await c.json();if(!c.ok)throw new Error(g.message||a("notification.loginFailed"));g.token&&(localStorage.setItem("authToken",g.token),window.location.href="/dashboard")}catch(c){x.error(a("notification.loginFailed"),{description:c instanceof Error?c.message:a("notification.tryAgain")})}finally{p(!1)}}:async d=>{if(d.preventDefault(),!!t.trim()){p(!0);try{const c=await fetch("/auth/send-link",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t}),credentials:"include"}),g=await c.json();if(!c.ok)throw new Error(g.message||a("notification.sendLinkFailed"));x.success(a("notification.linkSent"),{description:a("notification.checkEmail")})}catch(c){x.error(a("notification.sendLinkFailed"),{description:c instanceof Error?c.message:a("notification.tryAgain")})}finally{p(!1)}}},s=t.trim()&&(!u||m.trim());return e("div",{className:R("flex h-full flex-col",r),...n,children:[e("div",{className:"border-b px-6 py-4",children:[e("h2",{className:"text-lg font-semibold",children:a("welcome.heading")}),e("p",{className:"mt-1 text-sm text-muted-foreground",children:a("welcome.description")})]}),e("form",{className:"flex-1 overflow-auto px-6 py-4",onSubmit:y,children:e("div",{className:"space-y-4",children:[e("div",{className:"space-y-2",children:[e("div",{className:"flex items-center gap-2",children:[e(S,{htmlFor:"email",children:a("form.email")}),t.trim()&&e("a",{href:"#",className:"ml-auto text-xs underline-offset-2 hover:underline",onClick:d=>{d.preventDefault(),v(!u)},children:a(u?"form.sendLink":"form.loginWithPassword")})]}),e(C,{id:"email",type:"email",placeholder:"m@example.com",required:!0,value:t,onChange:d=>w(d.target.value)})]}),u&&e("div",{className:"space-y-2",children:[e(S,{htmlFor:"password",children:a("form.password")}),e(C,{id:"password",type:"password",required:!0,value:m,onChange:d=>f(d.target.value)})]}),e(F,{type:"submit",className:"w-full",disabled:!s||l,children:a(l?u?"button.loggingIn":"button.sendingLink":u?"button.login":"button.sendAuthLink")})]})}),e("div",{className:"border-t px-6 py-4",children:e(P,{})})]})}I.__docgenInfo={description:"",methods:[],displayName:"LoginForm"};const H=async(r,n)=>{const a=typeof r=="string"?r:r.toString(),t=n!=null&&n.body?JSON.parse(String(n.body)):{};return a.includes("/auth/send-link")?new Response(JSON.stringify({ok:!0,message:`Magic link sent to ${(t==null?void 0:t.email)??"user@example.com"}`}),{status:200,headers:{"Content-Type":"application/json"}}):a.includes("/auth/login")?new Response(JSON.stringify({ok:!0,token:"storybook-demo-token"}),{status:200,headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify({ok:!1}),{status:404,headers:{"Content-Type":"application/json"}})};function q({children:r}){return _(()=>{const n=globalThis.fetch;return globalThis.fetch=H,()=>{globalThis.fetch=n}},[]),e(j,{children:r})}const Z={title:"Auth/LoginForm",component:I,parameters:{layout:"fullscreen"},decorators:[r=>e(q,{children:e("div",{style:{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",padding:"24px",background:"radial-gradient(circle at 20% 20%, rgba(16,185,129,0.16), transparent 40%), linear-gradient(135deg, #0b1220 0%, #111827 55%, #031b16 100%)"},children:e("div",{style:{width:"100%",maxWidth:"420px",height:"700px",border:"1px solid rgba(255,255,255,0.12)",borderRadius:"16px",overflow:"hidden",background:"rgba(2, 6, 23, 0.82)",backdropFilter:"blur(10px)"},children:e(r,{})})})})],tags:["autodocs"]},b={};var T,A,M;b.parameters={...b.parameters,docs:{...(T=b.parameters)==null?void 0:T.docs,source:{originalSource:"{}",...(M=(A=b.parameters)==null?void 0:A.docs)==null?void 0:M.source}}};const ee=["PanelMode"];export{b as PanelMode,ee as __namedExportsOrder,Z as default};
