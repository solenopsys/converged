class a{name;scope="ai";template;provider;wrapName;decodeJson;constructor(t,r,o,e,s,n){this.name=t,this.template=r,this.provider=this.providers[o],this.wrapName=s,this.decodeJson=n??!1}async execute(t){let r=JSON.stringify(t),o=this.template.user.replace("{{data}}",r),{body:e}=await this.provider.request({system:this.template.system,user:o});console.log(`INFO: AiRequest (id: ${this.name}) received body:`,e);let s=e;if(this.decodeJson)try{let i=e.replace(/^```json\s*([\s\S]*?)\s*```$/,"$1");s=JSON.parse(i)}catch(i){throw console.error(`AiRequest (id: ${this.name}): Failed to parse JSON response. Error: ${i.message}. Body: ${e}`),new Error(`AiRequest (id: ${this.name}): Failed to parse JSON response.`)}return{[this.wrapName]:s}}}export{a as AiRequest};
